---
import BaseHead from '../../components/BaseHead.astro';
import Header from '../../components/Header.astro';
import Footer from '../../components/Footer.astro';
import { SITE_TITLE, SITE_DESCRIPTION } from '../../consts';
import { getCollection } from 'astro:content';
import FormattedDate from '../../components/FormattedDate.astro';

const posts = (await getCollection('blog')).sort(
        (a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf(),
);
---

<!doctype html>
<html lang="en">
        <head>
                <BaseHead title={`${SITE_TITLE} · Journal`} description={SITE_DESCRIPTION} />
                <style>
                        main {
                                width: min(1100px, calc(100% - 2rem));
                        }
                        .intro {
                                padding: 4rem 0 3rem;
                                text-align: center;
                                max-width: 720px;
                                margin: 0 auto;
                        }
                        .intro p {
                                color: rgb(var(--gray));
                                font-size: 1.1rem;
                        }
                        ul {
                                display: grid;
                                grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
                                gap: 2rem;
                                list-style-type: none;
                                margin: 0;
                                padding: 0 0 5rem;
                        }
                        li {
                                background: white;
                                border-radius: 18px;
                                padding: 2rem;
                                box-shadow: var(--box-shadow);
                                display: grid;
                                gap: 1rem;
                        }
                        li a {
                                text-decoration: none;
                                color: inherit;
                        }
                        li a:hover h4 {
                                color: var(--accent);
                        }
                        li img {
                                border-radius: 16px;
                                height: auto;
                        }
                        .meta {
                                color: rgb(var(--gray));
                                font-size: 0.95rem;
                        }
                </style>
        </head>
        <body>
                <Header />
                <main>
                        <section class="intro">
                                <p class="eyebrow">Journal</p>
                                <h1>Stories from behind the screens.</h1>
                                <p>
                                        Essays, playbooks, and reflections on designing products, leading teams, and building
                                        equitable experiences. Subscribe via RSS to stay in the loop.
                                </p>
                        </section>
                        <ul>
                                {posts.map((post) => (
                                        <li>
                                                <a href={`/blog/${post.id}/`}>
                                                        {post.data.heroImage && (
                                                                <img width={720} height={360} src={post.data.heroImage} alt="" />
                                                        )}
                                                        <h4>{post.data.title}</h4>
                                                        <p class="meta">
                                                                <FormattedDate date={post.data.pubDate} />
                                                                {post.data.updatedDate && (
                                                                        <span>
                                                                                {' '}
                                                                                · Updated <FormattedDate date={post.data.updatedDate} />
                                                                        </span>
                                                                )}
                                                        </p>
                                                        <p>{post.data.description}</p>
                                                </a>
                                        </li>
                                ))}
                        </ul>
                </main>
                <Footer />
        </body>
</html>
